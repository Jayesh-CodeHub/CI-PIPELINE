<html><head><title>Lint Report 1748338725</title><style>
body { font-family: Arial, sans-serif; padding: 20px; } h1, h2 { color: #087bff; } pre { background: #f4f4f4; padding: 10px; border-radius: 5px; }
</style></head><body>
<h1>Lint and Security Analysis Report</h1>
<p>Generated on: Tue May 27 09:38:45 UTC 2025</p>
<h2>Python Code Analysis</h2>
<h3>Pylint Report</h3><pre>
************* Module License
extracted_code/microbots/License.py:7: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/microbots/License.py:10: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/microbots/License.py:21: [C0304(missing-final-newline), ] Final newline missing
extracted_code/microbots/License.py:1: [C0114(missing-module-docstring), ] Missing module docstring
extracted_code/microbots/License.py:1: [C0103(invalid-name), ] Module name "License" doesn't conform to snake_case naming style
extracted_code/microbots/License.py:3: [C0116(missing-function-docstring), license_check] Missing function or method docstring
extracted_code/microbots/License.py:16: [W0718(broad-exception-caught), license_check] Catching too general exception Exception
extracted_code/microbots/License.py:12: [R1705(no-else-return), license_check] Unnecessary "else" after "return", remove the "else" and de-indent the code inside it
extracted_code/_ENHC0010271/scripts/microbots/License.py:7: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/microbots/License.py:10: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/microbots/License.py:21: [C0304(missing-final-newline), ] Final newline missing
extracted_code/_ENHC0010271/scripts/microbots/License.py:1: [C0114(missing-module-docstring), ] Missing module docstring
extracted_code/_ENHC0010271/scripts/microbots/License.py:1: [C0103(invalid-name), ] Module name "License" doesn't conform to snake_case naming style
extracted_code/_ENHC0010271/scripts/microbots/License.py:3: [C0116(missing-function-docstring), license_check] Missing function or method docstring
extracted_code/_ENHC0010271/scripts/microbots/License.py:16: [W0718(broad-exception-caught), license_check] Catching too general exception Exception
extracted_code/_ENHC0010271/scripts/microbots/License.py:12: [R1705(no-else-return), license_check] Unnecessary "else" after "return", remove the "else" and de-indent the code inside it
************* Module masterbot
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:14: [C0301(line-too-long), ] Line too long (121/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:19: [C0301(line-too-long), ] Line too long (121/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:21: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:42: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:59: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:78: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:107: [C0301(line-too-long), ] Line too long (102/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:108: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:130: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:154: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:188: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:189: [C0301(line-too-long), ] Line too long (131/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:192: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:194: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:200: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:202: [C0301(line-too-long), ] Line too long (122/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:206: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:209: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:212: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:219: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:227: [C0301(line-too-long), ] Line too long (110/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:240: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:243: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:248: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:252: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:259: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:262: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:266: [C0301(line-too-long), ] Line too long (102/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:270: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:273: [C0301(line-too-long), ] Line too long (171/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:276: [C0301(line-too-long), ] Line too long (134/100)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:283: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:288: [C0304(missing-final-newline), ] Final newline missing
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:1: [C0114(missing-module-docstring), ] Missing module docstring
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:1: [E0401(import-error), ] Unable to import 'paramiko'
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:2: [E0401(import-error), ] Unable to import 'openpyxl'
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:3: [E0401(import-error), ] Unable to import 'win32cred'
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:18: [E0401(import-error), ] Unable to import 'scripts.microbots.License'
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:18: [C0413(wrong-import-position), ] Import "from scripts.microbots.License import license_check" should be placed at the top of the module
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:35: [C0116(missing-function-docstring), get_credentials] Missing function or method docstring
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:48: [W0718(broad-exception-caught), get_credentials] Catching too general exception Exception
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:52: [C0116(missing-function-docstring), ssh_connect] Missing function or method docstring
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:87: [W0718(broad-exception-caught), ssh_connect] Catching too general exception Exception
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:79: [W0612(unused-variable), ssh_connect] Unused variable 'stdin'
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:79: [W0612(unused-variable), ssh_connect] Unused variable 'stderr'
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:95: [C0116(missing-function-docstring), write_to_report] Missing function or method docstring
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:120: [C0116(missing-function-docstring), send_email] Missing function or method docstring
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:120: [R0914(too-many-locals), send_email] Too many local variables (16/15)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:175: [W0718(broad-exception-caught), send_email] Catching too general exception Exception
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:123: [W1514(unspecified-encoding), send_email] Using open without explicitly specifying an encoding
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:178: [C0116(missing-function-docstring), main] Missing function or method docstring
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:178: [R0914(too-many-locals), main] Too many local variables (22/15)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:278: [W0718(broad-exception-caught), main] Catching too general exception Exception
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:186: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:222: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:225: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:265: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:284: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:178: [R0915(too-many-statements), main] Too many statements (67/50)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:4: [C0411(wrong-import-order), ] standard import "os" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:5: [C0411(wrong-import-order), ] standard import "sys" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:6: [C0411(wrong-import-order), ] standard import "json" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:7: [C0411(wrong-import-order), ] standard import "datetime.datetime" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:8: [C0411(wrong-import-order), ] standard import "smtplib" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:9: [C0411(wrong-import-order), ] standard import "email.mime.multipart.MIMEMultipart" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:10: [C0411(wrong-import-order), ] standard import "email.mime.text.MIMEText" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:11: [C0411(wrong-import-order), ] standard import "email.mime.base.MIMEBase" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:12: [C0411(wrong-import-order), ] standard import "email.encoders" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
************* Module license_data
extracted_code/_ENHC0010271/Conf/License/license_data.py:5: [C0304(missing-final-newline), ] Final newline missing
extracted_code/_ENHC0010271/Conf/License/license_data.py:1: [C0114(missing-module-docstring), ] Missing module docstring
extracted_code/_ENHC0010271/Conf/License/license_data.py:1: [W0622(redefined-builtin), license] Redefining built-in 'license'
extracted_code/_ENHC0010271/Conf/License/license_data.py:1: [C0116(missing-function-docstring), license] Missing function or method docstring
extracted_code/_ENHC0010271/Conf/License/license_data.py:2: [C0103(invalid-name), license] Variable name "BotID" doesn't conform to snake_case naming style
extracted_code/_ENHC0010271/Conf/License/license_data.py:3: [C0103(invalid-name), license] Variable name "BotName" doesn't conform to snake_case naming style
extracted_code/_ENHC0010271/Conf/License/license_data.py:4: [C0103(invalid-name), license] Variable name "ExpiryDate" doesn't conform to snake_case naming style
extracted_code/masterbot/masterbot.py:14: [C0301(line-too-long), ] Line too long (121/100)
extracted_code/masterbot/masterbot.py:19: [C0301(line-too-long), ] Line too long (121/100)
extracted_code/masterbot/masterbot.py:21: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:42: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:59: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:78: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:107: [C0301(line-too-long), ] Line too long (102/100)
extracted_code/masterbot/masterbot.py:108: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:130: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:154: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:188: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:189: [C0301(line-too-long), ] Line too long (131/100)
extracted_code/masterbot/masterbot.py:192: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:194: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:200: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:202: [C0301(line-too-long), ] Line too long (122/100)
extracted_code/masterbot/masterbot.py:206: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:209: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:212: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:219: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:227: [C0301(line-too-long), ] Line too long (110/100)
extracted_code/masterbot/masterbot.py:240: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:243: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:248: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:252: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:259: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:262: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:266: [C0301(line-too-long), ] Line too long (102/100)
extracted_code/masterbot/masterbot.py:270: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:273: [C0301(line-too-long), ] Line too long (171/100)
extracted_code/masterbot/masterbot.py:276: [C0301(line-too-long), ] Line too long (134/100)
extracted_code/masterbot/masterbot.py:283: [C0303(trailing-whitespace), ] Trailing whitespace
extracted_code/masterbot/masterbot.py:288: [C0304(missing-final-newline), ] Final newline missing
extracted_code/masterbot/masterbot.py:1: [C0114(missing-module-docstring), ] Missing module docstring
extracted_code/masterbot/masterbot.py:1: [E0401(import-error), ] Unable to import 'paramiko'
extracted_code/masterbot/masterbot.py:2: [E0401(import-error), ] Unable to import 'openpyxl'
extracted_code/masterbot/masterbot.py:3: [E0401(import-error), ] Unable to import 'win32cred'
extracted_code/masterbot/masterbot.py:18: [E0401(import-error), ] Unable to import 'scripts.microbots.License'
extracted_code/masterbot/masterbot.py:18: [C0413(wrong-import-position), ] Import "from scripts.microbots.License import license_check" should be placed at the top of the module
extracted_code/masterbot/masterbot.py:35: [C0116(missing-function-docstring), get_credentials] Missing function or method docstring
extracted_code/masterbot/masterbot.py:48: [W0718(broad-exception-caught), get_credentials] Catching too general exception Exception
extracted_code/masterbot/masterbot.py:52: [C0116(missing-function-docstring), ssh_connect] Missing function or method docstring
extracted_code/masterbot/masterbot.py:87: [W0718(broad-exception-caught), ssh_connect] Catching too general exception Exception
extracted_code/masterbot/masterbot.py:79: [W0612(unused-variable), ssh_connect] Unused variable 'stdin'
extracted_code/masterbot/masterbot.py:79: [W0612(unused-variable), ssh_connect] Unused variable 'stderr'
extracted_code/masterbot/masterbot.py:95: [C0116(missing-function-docstring), write_to_report] Missing function or method docstring
extracted_code/masterbot/masterbot.py:120: [C0116(missing-function-docstring), send_email] Missing function or method docstring
extracted_code/masterbot/masterbot.py:120: [R0914(too-many-locals), send_email] Too many local variables (16/15)
extracted_code/masterbot/masterbot.py:175: [W0718(broad-exception-caught), send_email] Catching too general exception Exception
extracted_code/masterbot/masterbot.py:123: [W1514(unspecified-encoding), send_email] Using open without explicitly specifying an encoding
extracted_code/masterbot/masterbot.py:178: [C0116(missing-function-docstring), main] Missing function or method docstring
extracted_code/masterbot/masterbot.py:178: [R0914(too-many-locals), main] Too many local variables (22/15)
extracted_code/masterbot/masterbot.py:278: [W0718(broad-exception-caught), main] Catching too general exception Exception
extracted_code/masterbot/masterbot.py:186: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/masterbot/masterbot.py:222: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/masterbot/masterbot.py:225: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/masterbot/masterbot.py:265: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/masterbot/masterbot.py:284: [W1514(unspecified-encoding), main] Using open without explicitly specifying an encoding
extracted_code/masterbot/masterbot.py:178: [R0915(too-many-statements), main] Too many statements (67/50)
extracted_code/masterbot/masterbot.py:4: [C0411(wrong-import-order), ] standard import "os" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:5: [C0411(wrong-import-order), ] standard import "sys" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:6: [C0411(wrong-import-order), ] standard import "json" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:7: [C0411(wrong-import-order), ] standard import "datetime.datetime" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:8: [C0411(wrong-import-order), ] standard import "smtplib" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:9: [C0411(wrong-import-order), ] standard import "email.mime.multipart.MIMEMultipart" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:10: [C0411(wrong-import-order), ] standard import "email.mime.text.MIMEText" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:11: [C0411(wrong-import-order), ] standard import "email.mime.base.MIMEBase" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:12: [C0411(wrong-import-order), ] standard import "email.encoders" should be placed before third party imports "paramiko", "openpyxl", "win32cred"
extracted_code/masterbot/masterbot.py:1: [R0801(duplicate-code), ] Similar lines in 2 files
==masterbot:[14:288]
==masterbot:[14:288]
sys.path.append(os.path.dirname(os.path.dirname(os.getcwd())))
parent_directory = os.path.dirname(os.path.dirname(os.path.dirname(os.path.realpath(__file__))))
config_file_path = os.path.join(parent_directory, "Conf", "config.json")
from scripts.microbots.License import license_check
#########################################################################################################################

# Define the list of commands
commands = [
    "rows 0",
    "system health status show",
    "storage shelf show -connectivity",
    "storage disk show -broken",
    "system health alert show -instance",
    "network port show",
    "network interface show -status",
    "network interface show -status-oper down",
    "volume show -state !online",
    "snapmirror show -healthy false"
]

def get_credentials():
    try:
        # Get license validation result first
        is_valid, message = license_check()
        if not is_valid:
            print(message)
            return None, None, False

        # Fetch the credentials from the Windows Credential Manager
        creds = win32cred.CredRead("Matalan", win32cred.CRED_TYPE_GENERIC, 0)
        username = creds['UserName']
        password = creds['CredentialBlob']
        return username, password.decode('utf-16'), True
    except Exception as e:
        print(f"Error retrieving credentials: {str(e)}")
        return None, None, False

def ssh_connect(server_ip, username, password, log_file, report_file):
    # Skip empty server IPs
    if not server_ip:
        error_msg = f"{datetime.now()} - Error: Skipping empty server IP\n"
        log_file.write(error_msg)
        print(error_msg)
        return False

    try:
        # Create SSH client
        ssh_client = paramiko.SSHClient()
        ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

        # Connect to the server using the IP address directly
        ssh_client.connect(hostname=server_ip, username=username, password=password)

        # Log connection details and print to console
        connection_msg = f"{datetime.now()} - Connected to {server_ip}\n"
        log_file.write(connection_msg)
        print(connection_msg)

        # Execute commands on the server
        for command in commands:
            command_msg = f"{datetime.now()} - Executing command on {server_ip}: {command}\n"
            log_file.write(command_msg)
            print(command_msg)

            stdin, stdout, stderr = ssh_client.exec_command(command)
            output = ''.join(stdout.readlines())
            write_to_report(report_file, server_ip, command, output)
            print(output)  # Print output to console

        # Close the SSH connection
        ssh_client.close()

    except Exception as e:
        error_msg = f"{datetime.now()} - Error connecting to {server_ip}: {str(e)}\n"
        log_file.write(error_msg)
        print(error_msg)
        return False  # Return False if there was an error connecting

    return True  # Return True if connected successfully

def write_to_report(report_file, server_ip, command, output):
    # Define keywords and their corresponding highlight colors
    highlight_mapping = {
        "ok": "#00FF00",  # Green
        "healthy": "#00FF00",  # Green
        "up": "#00FF00",  # Green
        "down": "#FF0000",  # Red
        "active": "green"
    }

    # Apply highlighting to the output
    for keyword, color in highlight_mapping.items():
        output = output.replace(keyword, f"<span style='background-color: {color};'>{keyword}</span>")

    # Wrap the output in a <pre> tag to preserve formatting
    output = f"<pre>{output}</pre>"

    # Write to the report file
    report_file.write("<tr>")
    report_file.write(f"<td>{server_ip}</td>")
    report_file.write(f"<td>{command}</td>")
    report_file.write(f"<td>{output}</td>")
    report_file.write("</tr>\n")


def send_email(subject, body, attachment_path):
    try:
        # Load email configuration from config.json
        with open(config_file_path) as f:
            config_data = json.load(f)
            email_config = config_data.get("email_config")

        if not email_config:
            print("Email configuration not found in config.json")
            return

        # Email configuration
        sender_email = email_config.get("sender_email")
        receiver_email = email_config.get("receiver_email")
        smtp_server = email_config.get("smtp_server")
        smtp_port = email_config.get("smtp_port")
        #smtp_username = email_config.get("smtp_username")
        #smtp_password = email_config.get("smtp_password")

        # Create a multipart message and set headers
        message = MIMEMultipart()
        message["From"] = sender_email
        message["To"] = receiver_email
        message["Subject"] = subject

        # Add body to email
        message.attach(MIMEText(body, "plain"))

        # Open the file to be sent
        with open(attachment_path, "rb") as attachment:
            # Add file as application/octet-stream
            part = MIMEBase("application", "octet-stream")
            part.set_payload(attachment.read())

            # Encode file in ASCII characters to send by email
            encoders.encode_base64(part)

            # Add header as key/value pair to attachment part
            part.add_header(
                "Content-Disposition",
                f"attachment; filename= {os.path.basename(attachment_path)}",
            )

            # Add attachment to message and convert message to string
            message.attach(part)
            text = message.as_string()

            # Send email
            with smtplib.SMTP(smtp_server, smtp_port) as server:
                server.starttls()
                #server.login(smtp_username, smtp_password)
                server.sendmail(sender_email, receiver_email, text)

            print(f"Email sent successfully to {receiver_email}")

    except Exception as e:
        print(f"Error sending email: {str(e)}")

def main():
    try:
        # First check if license is valid
        is_valid, message = license_check()
        if not is_valid:
            print(message)
            # Send email notification about expired license
            log_file_path = os.path.join(parent_directory, "log", "log.txt")
            with open(log_file_path, "w") as log_file:
                log_file.write(f"{datetime.now()} - {message}\n")
            send_email("Matalan NetApp Health-Check License Expired",
                      "The license for NetApp Health-Check has expired. Please renew your license to continue using this service.",
                      log_file_path)
            return  # Exit the function if license is not valid

        execution_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

        # Make sure the log and output directories exist
        log_dir = os.path.join(parent_directory, "log")
        output_dir = os.path.join(parent_directory, "output")
        os.makedirs(log_dir, exist_ok=True)
        os.makedirs(output_dir, exist_ok=True)

        # Load Excel file
        excel_file = os.path.join(parent_directory, "input", "server_details.xlsx")  # Change this to your Excel file path
        if not os.path.exists(excel_file):
            print(f"Error: Excel file not found at {excel_file}")
            return

        wb = openpyxl.load_workbook(excel_file)
        sheet = wb.active

        # Get credentials from Windows Credential Manager
        username, password, credentials_valid = get_credentials()

        if not credentials_valid:
            print("Failed to get valid credentials. Exiting.")
            return

        # Flag to track if there was any connection error
        connection_error = False

        # Open log file in write mode (overwrite existing content)
        log_file_path = os.path.join(log_dir, "log.txt")
        with open(log_file_path, "w") as log_file:
            # Open report file in write mode
            report_file_path = os.path.join(output_dir, "report.html")
            with open(report_file_path, "w") as report_file:
                # Write HTML header to report file
                report_file.write(f"<html><head><title>NetApp Health-Check Report - {execution_time}</title>")
                report_file.write("<style>")
                report_file.write("table {border-collapse: collapse; width: 100%;}")
                report_file.write("th, td {padding: 15px; text-align: left;}")
                report_file.write("th {background-color: #4CAF50; color: white;}")
                report_file.write("tr:nth-child(even) {background-color: #f2f2f2;}")
                report_file.write(".red {color: red;}")  # Define style for red class
                report_file.write(".green {color: green;}")  # Define style for green class
                report_file.write("</style>")
                report_file.write("</head><body>")
                report_file.write(f"<h1>Matalan NetApp Health-Check Report - {execution_time}</h1>")
                report_file.write("<table border='1' cellpadding='10'>")
                report_file.write("<tr><th>Server IP</th><th>Command</th><th>Output</th></tr>")

                # Flag to keep track if we processed any servers
                servers_processed = False

                # Iterate through rows and connect to servers
                for row in sheet.iter_rows(min_row=2, values_only=True):
                    if not row or len(row) < 1 or not row[0]:  # Skip empty rows or rows without IP
                        continue

                    server_ip = row[0]  # Assuming IP addresses are in the first column
                    if not server_ip or server_ip == "None" or server_ip == "":
                        continue  # Skip empty IP addresses

                    servers_processed = True
                    # Connect to the server and execute commands
                    connected = ssh_connect(server_ip, username, password, log_file, report_file)
                    # Check if there was an error connecting to the server
                    if not connected:
                        connection_error = True

                # Close HTML tags
                report_file.write("</table></body></html>")

        # If no servers were processed, log an error
        if not servers_processed:
            with open(log_file_path, "a") as log_file:
                error_msg = f"{datetime.now()} - Error: No valid server IPs found in the Excel file\n"
                log_file.write(error_msg)
                print(error_msg)
            connection_error = True

        # If there was a connection error, send the error email with log.txt
        if connection_error:
            send_email("Matalan NetApp Health-Check Report", "There was an error connecting to one or more servers. Please check the log file for details.", log_file_path)
        # If there was no connection error, send the report email with report.html
        else:
            send_email("Matalan NetApp Health-Check Report", "Please find attached the NetApp Health-Check Report.", report_file_path)

    except Exception as e:
        print(f"Error: {str(e)}")
        # Make sure the log directory exists
        log_dir = os.path.join(parent_directory, "log")
        os.makedirs(log_dir, exist_ok=True)

        with open(os.path.join(log_dir, "log.txt"), "a") as log_file:
            log_file.write(f"{datetime.now()} - Error: {str(e)}\n")

if __name__ == "__main__":
    main()
extracted_code/masterbot/masterbot.py:1: [R0801(duplicate-code), ] Similar lines in 2 files
==License:[3:21]
==License:[3:21]
    try:
        # Expiry date of the bot
        expiry_date = datetime.date(2024, 12, 31)

        # Get the current date
        current_date = datetime.date.today()

        # Check if the current date is before the expiry date
        if current_date <= expiry_date:
            return True, 'License is valid.'
        else:
            return False, 'License for this bot has expired.'
    except Exception as e:
        return False, f'Error validating license: {e}'

# Call the function and print the returned values
is_valid, message = license_check()
print(message)

-----------------------------------
Your code has been rated at 4.77/10

</pre>
<h3>Flake8 Report</h3><pre>
extracted_code/_ENHC0010271/Conf/License/license_data.py:4:41: E262 inline comment should start with '# '
extracted_code/_ENHC0010271/Conf/License/license_data.py:5:38: W292 no newline at end of file
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:14:80: E501 line too long (121 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:16:80: E501 line too long (96 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:18:1: E402 module level import not at top of file
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:19:80: E501 line too long (121 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:21:30: W291 trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:35:1: E302 expected 2 blank lines, found 1
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:42:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:52:1: E302 expected 2 blank lines, found 1
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:59:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:66:80: E501 line too long (84 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:75:80: E501 line too long (93 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:78:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:88:80: E501 line too long (85 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:95:1: E302 expected 2 blank lines, found 1
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:107:80: E501 line too long (102 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:108:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:130:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:136:9: E265 block comment should start with '# '
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:137:9: E265 block comment should start with '# '
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:154:63: W291 trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:170:17: E265 block comment should start with '# '
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:178:1: E302 expected 2 blank lines, found 1
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:188:70: W291 trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:189:23: E128 continuation line under-indented for visual indent
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:189:80: E501 line too long (131 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:189:132: W291 trailing whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:190:23: E128 continuation line under-indented for visual indent
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:192:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:194:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:200:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:202:80: E501 line too long (122 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:206:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:209:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:212:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:219:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:227:80: E501 line too long (110 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:229:80: E501 line too long (84 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:231:80: E501 line too long (82 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:232:80: E501 line too long (84 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:233:80: E501 line too long (85 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:234:80: E501 line too long (91 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:237:80: E501 line too long (100 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:239:80: E501 line too long (95 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:240:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:243:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:246:80: E501 line too long (99 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:248:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:249:80: E501 line too long (87 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:252:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:255:80: E501 line too long (97 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:259:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:262:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:266:80: E501 line too long (102 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:270:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:273:80: E501 line too long (171 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:274:80: E501 line too long (82 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:276:80: E501 line too long (134 > 79 characters)
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:283:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:287:1: E305 expected 2 blank lines after class or function definition, found 1
extracted_code/_ENHC0010271/scripts/masterbot/masterbot.py:288:11: W292 no newline at end of file
extracted_code/_ENHC0010271/scripts/microbots/License.py:3:1: E302 expected 2 blank lines, found 1
extracted_code/_ENHC0010271/scripts/microbots/License.py:7:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/microbots/License.py:10:1: W293 blank line contains whitespace
extracted_code/_ENHC0010271/scripts/microbots/License.py:20:1: E305 expected 2 blank lines after class or function definition, found 1
extracted_code/_ENHC0010271/scripts/microbots/License.py:21:15: W292 no newline at end of file
extracted_code/masterbot/masterbot.py:14:80: E501 line too long (121 > 79 characters)
extracted_code/masterbot/masterbot.py:16:80: E501 line too long (96 > 79 characters)
extracted_code/masterbot/masterbot.py:18:1: E402 module level import not at top of file
extracted_code/masterbot/masterbot.py:19:80: E501 line too long (121 > 79 characters)
extracted_code/masterbot/masterbot.py:21:30: W291 trailing whitespace
extracted_code/masterbot/masterbot.py:35:1: E302 expected 2 blank lines, found 1
extracted_code/masterbot/masterbot.py:42:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:52:1: E302 expected 2 blank lines, found 1
extracted_code/masterbot/masterbot.py:59:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:66:80: E501 line too long (84 > 79 characters)
extracted_code/masterbot/masterbot.py:75:80: E501 line too long (93 > 79 characters)
extracted_code/masterbot/masterbot.py:78:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:88:80: E501 line too long (85 > 79 characters)
extracted_code/masterbot/masterbot.py:95:1: E302 expected 2 blank lines, found 1
extracted_code/masterbot/masterbot.py:107:80: E501 line too long (102 > 79 characters)
extracted_code/masterbot/masterbot.py:108:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:130:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:136:9: E265 block comment should start with '# '
extracted_code/masterbot/masterbot.py:137:9: E265 block comment should start with '# '
extracted_code/masterbot/masterbot.py:154:63: W291 trailing whitespace
extracted_code/masterbot/masterbot.py:170:17: E265 block comment should start with '# '
extracted_code/masterbot/masterbot.py:178:1: E302 expected 2 blank lines, found 1
extracted_code/masterbot/masterbot.py:188:70: W291 trailing whitespace
extracted_code/masterbot/masterbot.py:189:23: E128 continuation line under-indented for visual indent
extracted_code/masterbot/masterbot.py:189:80: E501 line too long (131 > 79 characters)
extracted_code/masterbot/masterbot.py:189:132: W291 trailing whitespace
extracted_code/masterbot/masterbot.py:190:23: E128 continuation line under-indented for visual indent
extracted_code/masterbot/masterbot.py:192:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:194:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:200:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:202:80: E501 line too long (122 > 79 characters)
extracted_code/masterbot/masterbot.py:206:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:209:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:212:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:219:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:227:80: E501 line too long (110 > 79 characters)
extracted_code/masterbot/masterbot.py:229:80: E501 line too long (84 > 79 characters)
extracted_code/masterbot/masterbot.py:231:80: E501 line too long (82 > 79 characters)
extracted_code/masterbot/masterbot.py:232:80: E501 line too long (84 > 79 characters)
extracted_code/masterbot/masterbot.py:233:80: E501 line too long (85 > 79 characters)
extracted_code/masterbot/masterbot.py:234:80: E501 line too long (91 > 79 characters)
extracted_code/masterbot/masterbot.py:237:80: E501 line too long (100 > 79 characters)
extracted_code/masterbot/masterbot.py:239:80: E501 line too long (95 > 79 characters)
extracted_code/masterbot/masterbot.py:240:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:243:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:246:80: E501 line too long (99 > 79 characters)
extracted_code/masterbot/masterbot.py:248:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:249:80: E501 line too long (87 > 79 characters)
extracted_code/masterbot/masterbot.py:252:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:255:80: E501 line too long (97 > 79 characters)
extracted_code/masterbot/masterbot.py:259:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:262:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:266:80: E501 line too long (102 > 79 characters)
extracted_code/masterbot/masterbot.py:270:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:273:80: E501 line too long (171 > 79 characters)
extracted_code/masterbot/masterbot.py:274:80: E501 line too long (82 > 79 characters)
extracted_code/masterbot/masterbot.py:276:80: E501 line too long (134 > 79 characters)
extracted_code/masterbot/masterbot.py:283:1: W293 blank line contains whitespace
extracted_code/masterbot/masterbot.py:287:1: E305 expected 2 blank lines after class or function definition, found 1
extracted_code/masterbot/masterbot.py:288:11: W292 no newline at end of file
extracted_code/microbots/License.py:3:1: E302 expected 2 blank lines, found 1
extracted_code/microbots/License.py:7:1: W293 blank line contains whitespace
extracted_code/microbots/License.py:10:1: W293 blank line contains whitespace
extracted_code/microbots/License.py:20:1: E305 expected 2 blank lines after class or function definition, found 1
extracted_code/microbots/License.py:21:15: W292 no newline at end of file
</pre>
<h3>Security Analysis (Bandit)</h3><pre>
